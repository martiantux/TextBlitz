const c="You are a text completion assistant. Output clean, paste-ready text with no quotes, markdown formatting, or explanations. Generate natural variations of the requested content. Keep responses under 50 words unless explicitly asked for more. Never ask questions back or include placeholders like [brackets]. Output only the exact text the user needs.",a={enabled:!0,delimiter:" ",expandOnDelimiter:!0,caseSensitive:!1,debugMode:!1,darkMode:"system",customFolders:[],llmKeys:{},llmDefaultProvider:"groq",llmTimeout:5e3,llmMaxTokens:100,llmSystemPrompt:c,llmUsageAlert:80,llmModels:{groq:"llama-3.3-70b-versatile",openai:"gpt-4o-mini",anthropic:"claude-sonnet-4-20250514",gemini:"gemini-2.0-flash-exp"},llmTiers:{groq:"free",openai:"tier1",anthropic:"tier1",gemini:"free"}},h=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_LLM_SYSTEM_PROMPT:c,DEFAULT_SETTINGS:a},Symbol.toStringTag,{value:"Module"})),s=class s{static async initialize(){if(this.initialized){console.log("StorageManager: Already initialized, skipping");return}return this.initPromise?this.initPromise:(this.initPromise=this._doInitialize(),this.initPromise)}static async _doInitialize(){if(!this.initialized){if(this.initialized=!0,console.log("StorageManager: Starting initialization..."),typeof chrome>"u")throw new Error("chrome API is not available");if(!chrome.storage)throw new Error("chrome.storage API is not available");if(!chrome.storage.local)throw new Error("chrome.storage.local API is not available");console.log("StorageManager: ✅ chrome.storage.local is available");try{const e=await Promise.race([chrome.storage.local.get(["snippets","settings"]),new Promise((t,o)=>setTimeout(()=>o(new Error("Storage get timed out after 5000ms")),5e3))]),r=e.snippets||{};let n=!1;for(const t of Object.values(r))t.triggerMode||(t.triggerMode="word",n=!0),t.label||(t.label=t.trigger,n=!0);this.snippetCache=r,this.settingsCache={...a,...e.settings},n&&(console.log("StorageManager: Updating snippets with triggerMode"),await chrome.storage.local.set({snippets:this.snippetCache})),console.log("StorageManager: Loaded",Object.keys(this.snippetCache).length,"snippets"),(!e.settings||JSON.stringify(Object.keys(e.settings))!==JSON.stringify(Object.keys(a)))&&(console.log("StorageManager: Updating settings with new fields"),await chrome.storage.local.set({settings:this.settingsCache})),chrome.storage.onChanged.addListener((t,o)=>{o==="local"&&(t.snippets&&(this.snippetCache=t.snippets.newValue||{}),t.settings&&(this.settingsCache=t.settings.newValue||a))}),console.log("StorageManager: ✅ Initialized successfully")}catch(i){throw this.initialized=!1,this.initPromise=null,console.error("StorageManager: ❌ Failed to initialize:",i),i}}}static async getSnippets(){return this.initialized||await this.initialize(),this.snippetCache}static async getSnippet(i){return this.initialized||await this.initialize(),this.snippetCache[i]}static async saveSnippet(i){this.initialized||await this.initialize(),this.snippetCache[i.id]=i,await chrome.storage.local.set({snippets:this.snippetCache})}static async deleteSnippet(i){this.initialized||await this.initialize(),delete this.snippetCache[i],await chrome.storage.local.set({snippets:this.snippetCache})}static async getSettings(){return this.initialized||await this.initialize(),this.settingsCache}static async saveSettings(i){this.initialized||await this.initialize(),this.settingsCache=i,await chrome.storage.local.set({settings:i})}static async incrementUsage(i){this.initialized||await this.initialize();const e=this.snippetCache[i];e&&(e.usageCount++,e.lastUsed=Date.now(),await this.saveSnippet(e))}static async exportData(){return this.initialized||await this.initialize(),{snippets:this.snippetCache,settings:this.settingsCache}}static async importData(i){this.initialized||await this.initialize(),i.snippets&&(this.snippetCache={...this.snippetCache,...i.snippets},await chrome.storage.local.set({snippets:this.snippetCache})),i.settings&&(this.settingsCache={...this.settingsCache,...i.settings},await chrome.storage.local.set({settings:this.settingsCache}))}};s.snippetCache={},s.settingsCache=a,s.initialized=!1,s.initPromise=null;let l=s;export{l as S,h as t};
